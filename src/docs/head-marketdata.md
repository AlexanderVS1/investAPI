#Сервис котировок

Данный сервис предназначен для получения различной (в т.ч. исторической) биржевой информации. 
Существует два варианта взаимодействия с сервисом котировок: 

1. **Unary-методы** — данный вариант следует использовать в случаях, когда не требуется оперативность получения
информации или для загрузки исторических данных. Существует ограничение на количество запросов в минуту,
подробнее: [Лимитная политика](/doctest/limits).
2. **Bidirectional-stream** — используется для получения биржевой информации в реальном времени с минимально 
возможными задержками. Для работы со стрим-соединение также существуют ограничения, согласно [лимитной политикой](/doctest/limits).


##Получение исторических свечей

В процессе разработки торгового робота требуется анализировать различную историческую информацию. Например,
свечи. Для получения исторических свечей по инструменту можно использовать метод [getCandles](/doctest/marketdata#getcandles).

##Получение последних цен

В процессе работы алгоритма торговли может потребоваться получение цены последней сделки по инструменту или
инструментам. Для реализации данной потребности следует использовать метод [getLastPrices](/doctest/marketdata#getlastprices).
Используя данный метод вы можете получить последние цены всех доступных для торговли инструментов — для 
этого требуется передать пустой массив *instruments*.

Если для реализации алгоритма требуется оперативно получать информацию о цене последней сделки, то команда
TINKOFF INVEST API рекомендует использовать [подписку на поток обезличенных сделок](/doctest/marketdata#subscribetradesrequest) 
в рамках [stream-соединения сервиса](/doctest/marketdata#marketdatastream).

##Получение текущего стакана

Биржевой стакан — один из ключевых показателей торгового инструмента. Стакан содержит заявки пользователей
на покупку или продажу определённого инструмента (подробнее: [Биржевой стакан](https://www.tinkoff.ru/invest/account/help/trade-on-bs/bids/#q13)).
Для получения стакана можно использовать метод [getOrderbook](/doctest/marketdata#getorderbook). 

Для высоколиквидных инструментов на бирже стакан может изменяться несколько раз за секунду, поэтому 
использование unary-метода не всегда будет удобным. Поэтому рекомендуется использовать 
[подписку на стаканы](/doctest/marketdata#subscribeorderbookrequest) в рамках 
[stream-соединения сервиса](/doctest/marketdata#marketdatastream).

<a name="stream"></a>

##Bidirectional-stream получения биржевой информации

В рамках stream-соединения можно получать поток интересующих данных. В рамках одного соединения пользователь
может подписаться на получение:

1. стаканов; 

2. свечей; 

3. потока обезличенных сделок; 

4. статуса торговли инструментов.

Обратите внимание, что максимальное количество подписок на одно соединение ограничено [лимитной политикой](/doctest#_6) 
TINKOFF INVEST API. Однако, это ограничение **не распространяется** на подписку *info* (получение торгового
статуса инструмента).

**Важно!** В связи с тем, что агрегация и построение свечей являются сравнительно ресурсоёмкими операциями
(в масштабах всех торгуемых бумаг), команда TINKOFF INVEST API рекомендует реализовывать данную 
функциональность на стороне торгового робота. Сделать это можно используя подписку на поток обезличенных
сделок. 